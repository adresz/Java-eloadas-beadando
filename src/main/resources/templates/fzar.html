<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: head('Forex - Pozíció Zárás')}"></head>

<body class="is-preload">

<div id="wrapper">

    <!-- Sidebar -->
    <th:block th:replace="~{fragments/nav :: sidebar}"></th:block>

    <!-- Main -->
    <div id="main">
        <div class="inner">

            <!-- Header -->
            <header id="header">
                <a href="#" class="logo"><strong>Forex</strong> Zárás</a>
            </header>

            <!-- Content -->
            <section>
                <h1>Pozíció Lezárása</h1>

                <!-- Űrlap -->
                <div class="box">
                    <form th:action="@{/fzar}" method="post">
                        <label for="tradeId">Válaszd ki a lezárandó pozíciót:</label>
                        <select name="tradeId" id="tradeId" class="select" required>
                            <option value="">-- Válassz pozíciót --</option>
                            <option th:each="t : ${trades}"
                                    th:value="${t.id}"
                                    th:text="'ID: ' + ${t.id} + ' | ' + ${t.instrument} + ' | Mennyiség: ' + ${t.currentUnits} + ' | P/L: ' + ${#numbers.formatDecimal(t.unrealizedPL, 1, 2)}">
                            </option>
                        </select>

                        <button type="submit" class="primary">Pozíció lezárása</button>
                    </form>
                </div>

                <!-- Sikeres üzenet -->
                <div th:if="${msg}" class="box" style="background:#e8f5e9; border-left:4px solid #4caf50;">
                    <p style="color:#2e7d32; margin:0;" th:text="${msg}"></p>
                </div>

                <!-- Hibás üzenet -->
                <div th:if="${error}" class="box" style="background:#ffebee; border-left:4px solid #e74c3c;">
                    <p style="color:#c0392b; margin:0;" th:text="${error}"></p>
                </div>

                <!-- Nincs nyitott pozíció -->
                <div th:if="${trades == null or trades.isEmpty()}" style="text-align:center; color:#999; padding:40px;">
                    <p>Nincs lezárható pozíció.</p>
                </div>

                <!-- Vissza gomb -->
                <div style="text-align:center; margin-top:30px;">
                    <a th:href="@{/dashboard}" class="button">Vissza a Dashboardra</a>
                </div>
            </section>

        </div>
    </div>
</div>

<!-- Scripts -->
<th:block th:replace="~{fragments/scripts :: scripts}"></th:block>

</body>
</html>